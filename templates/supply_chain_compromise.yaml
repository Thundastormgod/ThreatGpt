# Supply Chain Compromise Simulation
# Advanced persistent threat targeting software supply chain through compromised vendor updates

metadata:
  name: "Supply Chain Compromise Attack"
  description: "Sophisticated APT simulation targeting software development pipeline through compromised third-party vendor updates and malicious code injection"
  version: "2.0.0"
  author: "Advanced Threat Research Lab"
  created_at: "2024-01-08T13:45:00Z"
  updated_at: "2024-01-25T11:20:00Z"
  tags:
    - "supply_chain"
    - "apt"
    - "software_compromise"
    - "vendor_targeting"
    - "code_injection"
    - "build_pipeline"
    - "third_party_risk"
  references:
    - "https://attack.mitre.org/techniques/T1195/"
    - "https://www.cisa.gov/news-events/cybersecurity-advisories/aa21-062a"
    - "https://www.nist.gov/itl/executive-order-improving-nations-cybersecurity/enhancing-software-supply-chain-security"

threat_type: "supply_chain"
delivery_vector: "network_intrusion"

target_profile:
  role: "Senior DevOps Engineer"
  seniority: "senior"
  department: "engineering"
  technical_level: "expert"
  industry: "technology"
  company_size: "large"
  typical_working_hours: "9:00-18:00 PST"
  communication_style: "technical_direct"
  security_awareness_level: 7
  interests:
    - "automation"
    - "infrastructure_as_code"
    - "container_orchestration"
    - "ci_cd_pipelines"
    - "cloud_native_technologies"
  social_media_presence:
    github: "very_active_public"
    linkedin: "moderate_professional"
    twitter: "technical_discussions"
    stackoverflow: "regular_contributor"

behavioral_pattern:
  mitre_attack_techniques:
    - "T1195.001"  # Supply Chain Compromise: Compromise Software Dependencies and Development Tools
    - "T1195.002"  # Supply Chain Compromise: Compromise Software Supply Chain
    - "T1195.003"  # Supply Chain Compromise: Compromise Hardware Supply Chain
    - "T1199"      # Trusted Relationship
    - "T1078.004"  # Valid Accounts: Cloud Accounts
    - "T1543.003"  # Create or Modify System Process: Windows Service
  mitre_attack_tactics:
    - "Initial Access"
    - "Persistence"
    - "Defense Evasion"
    - "Collection"
    - "Command and Control"
  psychological_triggers:
    - "trust_in_vendors"
    - "routine_update_process"
    - "legitimate_looking_notifications"
    - "urgency_for_security_patches"
    - "automation_dependency"
  social_engineering_tactics:
    - "vendor_impersonation"
    - "legitimate_update_mimicking"
    - "security_patch_urgency"
    - "developer_tool_compromise"
    - "open_source_contribution_abuse"
  technical_methods:
    - "code_signing_certificate_compromise"
    - "build_system_infiltration"
    - "dependency_confusion_attack"
    - "typosquatting_packages"
    - "malicious_container_images"
  evasion_techniques:
    - "legitimate_software_signing"
    - "gradual_payload_deployment"
    - "environment_specific_activation"
    - "dormant_code_insertion"

difficulty_level: 10
estimated_duration: 120

simulation_parameters:
  max_iterations: 5
  max_duration_minutes: 180
  escalation_enabled: true
  response_adaptation: true
  time_pressure_simulation: false
  multi_stage_attack: true
  persistence_simulation: true
  language: "en-US"
  tone: "technical_professional"
  urgency_level: 4
  compliance_mode: true
  content_filtering: true
  audit_logging: true

custom_parameters:
  attack_timeline:
    phase_1_reconnaissance:
      duration_weeks: 4
      activities:
        - "target_organization_profiling"
        - "vendor_relationship_mapping"
        - "development_tool_identification"
        - "build_pipeline_analysis"
        - "open_source_dependency_analysis"
    
    phase_2_vendor_compromise:
      duration_weeks: 8
      targets:
        - "third_party_library_maintainers"
        - "build_tool_vendors"
        - "container_registry_providers"
        - "package_repository_managers"
    
    phase_3_malicious_injection:
      duration_weeks: 2
      injection_points:
        - "npm_package_dependencies"
        - "docker_base_images"
        - "maven_artifacts"
        - "nuget_packages"
        - "python_pip_packages"
    
    phase_4_deployment:
      duration_weeks: 1
      distribution_methods:
        - "automatic_dependency_updates"
        - "scheduled_build_deployments"
        - "security_patch_distributions"
        - "container_image_pulls"
  
  target_technologies:
    development_tools:
      - tool: "Jenkins"
        attack_vector: "malicious_plugin_installation"
        persistence: "scheduled_job_modification"
      - tool: "GitLab CI/CD"
        attack_vector: "runner_compromise"
        persistence: "pipeline_yaml_modification"
      - tool: "Docker Registry"
        attack_vector: "malicious_base_image"
        persistence: "layer_injection"
    
    package_managers:
      - manager: "npm"
        attack_vector: "typosquatting"
        persistence: "dependency_update_hook"
      - manager: "Maven"
        attack_vector: "repository_compromise"
        persistence: "build_lifecycle_binding"
      - manager: "NuGet"
        attack_vector: "package_substitution"
        persistence: "msbuild_target_injection"
    
    cloud_services:
      - service: "AWS CodeBuild"
        attack_vector: "buildspec_modification"
        persistence: "iam_role_escalation"
      - service: "Azure DevOps"
        attack_vector: "extension_compromise"
        persistence: "service_connection_abuse"
      - service: "Google Cloud Build"
        attack_vector: "cloudbuild_yaml_injection"
        persistence: "service_account_compromise"
  
  malicious_payloads:
    reconnaissance_stage:
      - capability: "environment_enumeration"
        stealth_level: "high"
        data_collected: ["system_info", "network_topology", "installed_software"]
      - capability: "credential_harvesting"
        stealth_level: "medium"
        data_collected: ["api_keys", "certificates", "database_credentials"]
    
    persistence_stage:
      - capability: "backdoor_installation"
        stealth_level: "high"
        mechanism: "legitimate_service_modification"
      - capability: "privilege_escalation"
        stealth_level: "medium"
        mechanism: "service_account_compromise"
    
    exfiltration_stage:
      - capability: "source_code_theft"
        stealth_level: "high"
        method: "encrypted_transmission"
      - capability: "intellectual_property_theft"
        stealth_level: "high"
        method: "gradual_data_collection"
  
  detection_evasion:
    code_obfuscation:
      - technique: "polymorphic_code"
        effectiveness: "high"
        detection_difficulty: "expert"
      - technique: "environmental_keying"
        effectiveness: "medium"
        detection_difficulty: "advanced"
    
    timing_evasion:
      - technique: "delayed_activation"
        delay_period: "30_days"
        trigger: "specific_build_count"
      - technique: "working_hours_only"
        active_hours: "business_hours_pst"
        dormant_weekends: true
    
    legitimate_behavior_mimicking:
      - behavior: "normal_update_patterns"
        frequency: "weekly"
        timing: "tuesday_maintenance_window"
      - behavior: "standard_logging_format"
        log_integration: "existing_systems"
        anomaly_masking: true
  
  supply_chain_mapping:
    direct_dependencies:
      critical_libraries:
        - name: "authentication_framework"
          risk_level: "high"
          usage_pattern: "core_functionality"
        - name: "data_processing_library"
          risk_level: "medium"
          usage_pattern: "batch_operations"
    
    indirect_dependencies:
      transitive_risks:
        - depth_level: 3
          visibility: "low"
          update_frequency: "infrequent"
        - depth_level: 5
          visibility: "none"
          update_frequency: "abandoned"
  
  success_metrics:
    primary_objectives:
      - "persistent_code_execution"
      - "development_environment_access"
      - "build_pipeline_compromise"
      - "source_code_access"
    secondary_objectives:
      - "credential_harvest"
      - "network_lateral_movement"
      - "additional_vendor_compromise"
      - "long_term_persistence"
  
  defensive_measures_testing:
    supply_chain_security_controls:
      - control: "software_composition_analysis"
        bypass_difficulty: "medium"
        detection_likelihood: "high"
      - control: "code_signing_verification"
        bypass_difficulty: "high"
        detection_likelihood: "medium"
      - control: "build_environment_isolation"
        bypass_difficulty: "medium"
        detection_likelihood: "low"
    
    monitoring_detection:
      - indicator: "unusual_network_traffic"
        detection_difficulty: "low"
        false_positive_rate: "medium"
      - indicator: "unauthorized_code_modifications"
        detection_difficulty: "medium"
        false_positive_rate: "low"
      - indicator: "anomalous_build_behavior"
        detection_difficulty: "high"
        false_positive_rate: "high"
  
  compliance_considerations:
    regulatory_frameworks:
      - framework: "NIST_Cybersecurity_Framework"
        relevant_controls: ["ID.SC", "PR.DS", "DE.CM"]
      - framework: "ISO_27001"
        relevant_controls: ["A.15.1", "A.15.2", "A.12.6"]
    
    industry_standards:
      - standard: "SLSA_Framework"
        maturity_level: "level_3"
        implementation_gap: "build_provenance"
      - standard: "NIST_SSDF"
        practice_areas: ["PO", "PS", "PW", "RV"]